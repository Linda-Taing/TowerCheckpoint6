import{l as _,f as E,A as l,_ as k,g as T,o as A,c as y,P as i,h as f,i as x,a as c,b as t,j as v,t as m,F as I,r as w,w as D,v as N,u as S,k as b,d as r,p as B,e as G}from"./index.f9475ecf.js";import{a as p}from"./AttendeesService.c89a2e06.js";class C{constructor(s){this.id=s.id,this.body=s.body,this.isAttending=s.isAttending,this.eventId=s.eventId,this.creatorId=s.creatorId,this.creator=s.creator}}class O{async getEventComments(s){_.log(s);const a=await E.get(`api/events/${s}/comments`);_.log("[Comments in the Service]",a.data);const e=a.data.map(u=>new C(u));l.comments=e}async createComment(s){const a=await E.post("api/comments",s);return _.log("[CREATING COMMENT]",a.data),l.comments.push(new C(a.data)),a.data}async deleteEventCommentsById(s){const a=await E.delete(`api/comments/${s}`);_.log("[Comments By Id in the Service]",a.data);const e=l.comments.findIndex(u=>u.commentId==s);s!==-1&&l.comments.splice(e,1)}}const g=new O;const M={setup(){const d=T({}),s=S();async function a(){try{const o=s.params.eventId;await f.getEventById(o)}catch(o){i.error(o,"[GETTING EVENT BY ID]")}}async function e(){try{const o=s.params.eventId;await g.getEventComments(o)}catch(o){i.error(o,"[GETTING EVENT COMMENTS]")}}async function u(){try{const o=s.params.eventId;await p.getEventTickets(o)}catch(o){i.error(o,"[GETTING ATTENDEES?]")}}return A(()=>{e(),a(),u()}),{editable:d,account:y(()=>l.account),comments:y(()=>l.comments),currentEvent:y(()=>l.currentEvent),tickets:y(()=>l.tickets),isAttending:y(()=>l.tickets.find(o=>o.accountId==l.account.id)),async cancelEvent(o){try{const n=s.params.eventId;await i.confirm("Are you sure you want to delete this event?")&&await f.cancelEvent(n)}catch(n){_.log(n),i.error("You CANNOT cancel an event you did not create",n),x.push("/")}},async deleteEventCommentsById(o){try{await i.confirm("Are you sure you want to delete this comment?")&&await g.deleteEventCommentsById(o)}catch(n){_.log("[comments with IDs]"),i.error(n),_.log("[ARE YOU DELETED?]")}},async createComment(){try{const o=d.value;o.eventId=s.params.eventId,await g.createComment(o),d.value={}}catch(o){i.error(o)}},async createTicket(){try{await p.createTicket({eventId:s.params.eventId})}catch(o){_.log(o),i.error(o,"[Am I creating a ticket?]")}},async deleteTicket(o){try{await i.confirm("Are you sure you DO NOT want to attend?")&&await p.deleteTicket(o)}catch(n){_.log(n),i.error(n.message)}}}}},h=d=>(B("data-v-de8d5f70"),d=d(),G(),d),V={key:0},F=h(()=>t("h1",{class:"bg-dark p-2"},"Tower: Event Details",-1)),P={class:"container"},R={class:"row"},Y={class:"col-md-12 card"},j={class:"card-title"},L={key:0},U=h(()=>t("p",{class:"text-danger fs-1 text-center"},"Cancelled Event",-1)),H=[U],W=["src"],q={class:"p-2"},z={key:0,class:"p- 2"},J={key:0},K={class:"fw-bold"},Q={class:"fw-bold"},X={class:"fw-bold pb-0"},Z=b("Description: "),$={class:"pt-0"},tt={key:1},et=h(()=>t("p",{class:"text-danger fs-1 text-center"}," Sold-Out",-1)),st=[et],nt={class:"fw-bold"},ot={key:0,class:"container Attending-Section"},ct={class:"row"},rt={class:"col-md-12 card"},at=h(()=>t("h1",null,"Who is attending?:",-1)),it={class:"p-3"},dt=["src"],lt={class:"container"},_t={class:"row"},vt={class:"mb-3 col-10 ms-5"},mt=h(()=>t("h1",null,"Comments:",-1)),ht=h(()=>t("label",{for:"exampleFormControlInput1",class:"p-2 fw-bold form-label"},"Add Comment Here:",-1)),ut=h(()=>t("button",{class:"btn btn-success p-1 mt-3"},"Add Comment",-1)),yt=[ut],Et={class:"col-md-12"},pt={class:"mt-3 p-2 card rounded-0"},gt=["src"],ft={class:"p-3"},It={class:"ms-3"},wt={class:"d-flex justify-content-end"},Ct={key:0},bt=["onClick"],kt={key:1,class:"loading"},Tt=h(()=>t("h1",{class:"text-center"},"loading...",-1)),At=[Tt];function xt(d,s,a,e,u,o){return e.currentEvent?(r(),c("section",V,[F,t("div",P,[t("div",R,[t("div",Y,[t("div",j,[e.currentEvent.isCanceled?(r(),c("div",L,H)):v("",!0),t("h2",null,m(e.currentEvent.name),1)]),t("img",{class:"pic p-2",src:e.currentEvent.coverImg,alt:""},null,8,W),t("div",q,[e.account.id&&!e.currentEvent.isCanceled?(r(),c("div",z,[e.currentEvent.capacity==0?(r(),c("div",J)):v("",!0),e.isAttending?v("",!0):(r(),c("button",{key:1,onClick:s[0]||(s[0]=n=>e.createTicket(e.currentEvent.id)),class:"btn btn-success"},"Attend Event ")),!e.currentEvent.isCanceled&&e.currentEvent.creatorId==e.account.id?(r(),c("button",{key:2,onClick:s[1]||(s[1]=n=>e.cancelEvent(e.currentEvent.id)),class:"btn btn-danger w-25"},"Remove Event")):v("",!0)])):v("",!0),t("p",K,"Date of event: "+m(e.currentEvent.startDate),1),t("p",Q,"Type of event: "+m(e.currentEvent.type),1),t("p",X,[Z,t("p",$,m(e.currentEvent.description),1)]),e.currentEvent.capacity==0?(r(),c("div",tt,st)):v("",!0),t("p",nt,"capacity: "+m(e.currentEvent.capacity),1)])])])]),e.tickets?(r(),c("div",ot,[t("div",ct,[t("div",rt,[at,(r(!0),c(I,null,w(e.tickets,n=>(r(),c("div",it,[b(m(n.profile.name)+" ",1),t("img",{class:"rounded-circle",height:"50",width:"50",src:n.profile.picture,alt:""},null,8,dt)]))),256))])])])):v("",!0),t("div",lt,[t("div",_t,[t("div",vt,[mt,ht,D(t("input",{type:"email",class:"mt-1 form-control","onUpdate:modelValue":s[2]||(s[2]=n=>e.editable.body=n),id:"exampleFormControlInput1",placeholder:"Your thoughts here!!"},null,512),[[N,e.editable.body]]),t("div",{onClick:s[3]||(s[3]=n=>e.createComment()),class:"d-flex justify-content-end"},yt)]),(r(!0),c(I,null,w(e.comments,n=>(r(),c("div",Et,[t("div",null,[t("div",pt,[t("img",{class:"p-3 rounded-circle",title:"Profile Picture",height:"100",width:"100",src:n.creator.picture,alt:""},null,8,gt),t("p",ft,m(n==null?void 0:n.creator.name),1),t("p",It,m(n==null?void 0:n.body),1),t("div",wt,[e.account.id==n.creatorId?(r(),c("div",Ct,[t("button",{onClick:Dt=>e.deleteEventCommentsById(n==null?void 0:n.id),class:"btn btn-danger ms-3"},"Delete Comment",8,bt)])):v("",!0)])])])]))),256))])])])):(r(),c("section",kt,At))}const Bt=k(M,[["render",xt],["__scopeId","data-v-de8d5f70"]]);export{Bt as default};
